local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

_G.noKillList = {}

local function addToNoKillList(displayNames)
    for _, displayName in pairs(displayNames) do
        for _, player in pairs(Players:GetPlayers()) do
            if player.DisplayName:lower() == displayName:lower() then
                _G.noKillList[player.Name] = true
                makePlayerVisible(player)
                break
            end
        end
    end
end

local function makePlayerVisible(player)
    local character = player.Character
    if character then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Transparency = 0
            elseif part:IsA("BillboardGui") then
                part.Enabled = true
            end
        end
    end
end

LocalPlayer.Chatted:Connect(function(message)
    if message:sub(1, 7):lower() == ";nokill" then
        local displayName = message:sub(9):trim()
        addToNoKillList({displayName})
    end
end)

Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        if _G.noKillList[player.Name] then
            makePlayerVisible(player)
        end
    end)
end)

-- Create the GUI Window
local Window = Fluent:CreateWindow({
    Title = "Fluent " .. Fluent.Version,
    SubTitle = "by dawid",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

-- Prepare the player names for the dropdown
local playerNames = {}
for _, player in pairs(Players:GetPlayers()) do
    table.insert(playerNames, player.DisplayName)
end

-- Dropdown for the No Kill List
local Dropdown = Window:AddDropdown("NoKillListDropdown", {
    Title = "Select Players to Add to No Kill List",
    Values = playerNames,
    Multi = true,  -- Enable multi-selection
    Callback = function(selectedNames)
        addToNoKillList(selectedNames)
    end,
})

-- Refresh the dropdown values whenever a player joins
Players.PlayerAdded:Connect(function(player)
    table.insert(playerNames, player.DisplayName)
    Dropdown:UpdateValues(playerNames)
end)

Window:SelectTab(1)

Fluent:Notify({
    Title = "Admin Panel",
    Content = "The admin panel has been loaded.",
    Duration = 5
})
