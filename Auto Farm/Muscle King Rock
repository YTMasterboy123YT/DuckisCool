-- Create a ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Create a TextButton
local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 200, 0, 50)
button.Position = UDim2.new(0.5, -100, 0.5, -25)
button.Text = "Teleport Rock"
button.Parent = screenGui
button.BackgroundColor3 = Color3.new(0, 0.5, 0) -- Green color
button.TextColor3 = Color3.new(1, 1, 1) -- White text

local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local muscleKingMountain = game.Workspace:FindFirstChild("machinesFolder"):FindFirstChild("Muscle King Mountain")
local rockPart = muscleKingMountain:FindFirstChild("Rock")

local originalPosition = rockPart.Position
local originalSize = rockPart.Size
local isOn = false
local runService = game:GetService("RunService")

button.MouseButton1Click:Connect(function()
    isOn = not isOn
    if isOn then
        -- Teleport the rock to the right hand CFrame
        if character and character:FindFirstChild("RightHand") and rockPart then
            rockPart.CFrame = character.RightHand.CFrame * CFrame.new(0, 1, 0) -- Position above the right hand
            rockPart.Transparency = 1 -- Make the rock invisible

            -- Remove StatLabels and other objects inside rockGui
            local rockGui = rockPart:FindFirstChild("rockGui")
            if rockGui then
                for _, child in ipairs(rockGui:GetChildren()) do
                    if child:IsA("TextLabel") and (child.Name == "statLabel" or child.Name == "rockName") then
                        child:Destroy()
                        print(child.Name .. " deleted from rockGui.")
                    end
                end
            end

            -- Remove rockEmitter and hoopParticle if they exist
            local rockEmitter = rockPart:FindFirstChild("rockEmitter")
            if rockEmitter then
                rockEmitter:Destroy()
                print("rockEmitter deleted.")
            end

            local hoopParticle = rockPart:FindFirstChild("hoopParticle")
            if hoopParticle then
                hoopParticle:Destroy()
                print("hoopParticle deleted.")
            end

            button.Text = "Return Rock"

            -- Loop to anchor the rock to the right hand
            local connection
            connection = runService.RenderStepped:Connect(function()
                if isOn and character and character:FindFirstChild("RightHand") then
                    rockPart.CFrame = character.RightHand.CFrame * CFrame.new(0, 1, 0) -- Keep it above the right hand
                else
                    connection:Disconnect() -- Stop the loop when turned off
                end
            end)
        end
    else
        rockPart.Position = originalPosition
        rockPart.Size = originalSize
        rockPart.Transparency = 0 -- Make the rock visible again
        button.Text = "Teleport Rock"
    end
end)

player.CharacterAdded:Connect(function(newCharacter)
    character = newCharacter
end)
